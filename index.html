<!doctype html>
<html lang="uk">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"/>
  <title>–ù–†–ö ‚Äî –æ—Ü—ñ–Ω—é–≤–∞–Ω–Ω—è (2026 | –ø–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è + –≤–∏—Å–Ω–æ–≤–æ–∫)</title>
  <style>
    :root {
      --bg: #0b1220; --card: #111b2e; --muted: #93a4c7; --text: #e7eefc;
      --accent: #4da3ff; --ok: #2ee59d; --bad: #ff5c7a; --warn: #ffcc66;
      --line: rgba(255,255,255,.10); --r: 14px;
    }
    * { box-sizing: border-box; }
    body { margin: 0; background: linear-gradient(180deg,#071022,#0b1220); color: var(--text); font-family: system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif; }
    header { position: sticky; top: 0; z-index: 5; background: rgba(7,16,34,.92); backdrop-filter: blur(10px); border-bottom: 1px solid var(--line); }
    .wrap { max-width: 1100px; margin: 0 auto; padding: 12px 14px; }
    h1 { font-size: 18px; margin: 6px 0 2px; }
    .sub { font-size: 12px; color: var(--muted); margin: 0 0 8px; }
    .tabs { display: flex; gap: 8px; flex-wrap: wrap; margin-top: 10px; }
    .tab { border: 1px solid var(--line); background: transparent; color: var(--text); padding: 8px 10px; border-radius: 999px; font-size: 13px; cursor: pointer; }
    .tab.active { background: rgba(77,163,255,.18); border-color: rgba(77,163,255,.45); }
    main { padding: 14px; }
    .grid { display: grid; gap: 12px; }
    @media (min-width: 980px) { .grid.cols2 { grid-template-columns: 1fr 1fr; } }
    .card { background: rgba(17,27,46,.92); border: 1px solid var(--line); border-radius: var(--r); padding: 12px; }
    .card h2 { font-size: 14px; margin: 0 0 10px; color: #cfe0ff; }
    label { display: block; font-size: 12px; color: var(--muted); margin: 10px 0 6px; }
    input, select, textarea {
      width: 100%; border-radius: 12px; border: 1px solid var(--line);
      background: rgba(0,0,0,.18); color: var(--text); padding: 10px; font-size: 14px; outline: none;
    }
    textarea { min-height: 70px; resize: vertical; }
    .row { display: flex; gap: 10px; }
    .row > * { flex: 1; }
    .btnrow { display: flex; gap: 10px; flex-wrap: wrap; margin-top: 12px; }
    button.primary { background: rgba(77,163,255,.22); border: 1px solid rgba(77,163,255,.55); color: var(--text); }
    button.ghost { background: transparent; border: 1px solid var(--line); color: var(--text); }
    button.danger { background: rgba(255,92,122,.18); border: 1px solid rgba(255,92,122,.5); color: var(--text); }
    button { padding: 10px 14px; border-radius: 12px; cursor: pointer; font-size: 14px; }
    .pill { display: inline-flex; align-items: center; gap: 6px; border: 1px solid var(--line); border-radius: 999px; padding: 6px 10px; font-size: 12px; color: var(--muted); }
    .pill strong { color: var(--text); font-weight: 700; }
    .small { font-size: 12px; color: var(--muted); }
    .kpi { display: flex; gap: 10px; flex-wrap: wrap; }
    .hide { display: none; }
    .divider { height: 1px; background: var(--line); margin: 12px 0; }

    .crit { border: 1px solid var(--line); border-radius: 14px; padding: 12px; margin: 12px 0; background: rgba(0,0,0,.10); }
    .critTop { display: flex; align-items: center; justify-content: space-between; gap: 10px; }
    .critName b { font-size: 13px; color: var(--text); }
    .critName span { font-size: 12px; color: var(--muted); }
    .critActions { display: flex; align-items: center; gap: 8px; }
    .helpBtn { padding: 7px 10px; border-radius: 999px; border: 1px solid rgba(77,163,255,.45); background: rgba(77,163,255,.14); color: var(--text); font-size: 12px; cursor: pointer; }
    .weightTag { font-size: 12px; color: var(--muted); border: 1px solid var(--line); border-radius: 999px; padding: 6px 10px; }
    .err { color: var(--warn); }

    .modalOverlay { position: fixed; inset: 0; background: rgba(0,0,0,.65); display: none; align-items: center; justify-content: center; padding: 16px; z-index: 100; }
    .modal { width: min(900px, 95%); max-height: 90vh; overflow-y: auto; background: rgba(17,27,46,.98); border: 1px solid var(--line); border-radius: 18px; padding: 20px; }
    .modal h3 { margin: 0 0 12px; font-size: 17px; color: #cfe0ff; }
    .modal .box { border: 1px solid var(--line); border-radius: 14px; padding: 14px; margin: 14px 0; background: rgba(0,0,0,.15); white-space: pre-wrap; line-height: 1.5; }
    .modalCloseRow { display: flex; justify-content: flex-end; gap: 12px; margin-top: 16px; }

    table { width: 100%; border-collapse: collapse; margin-top: 16px; font-size: 13px; }
    th, td { padding: 8px 10px; border: 1px solid var(--line); text-align: center; }
    th { background: rgba(0,0,0,.25); }
    td.highlight { font-weight: bold; color: var(--accent); }
  </style>
</head>
<body>

<header>
  <div class="wrap">
    <h1>–ù–†–ö ‚Äî –æ—Ü—ñ–Ω—é–≤–∞–Ω–Ω—è (2026 | –ø–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è + –≤–∏—Å–Ω–æ–≤–æ–∫)</h1>
    <p class="sub">–û–±–µ—Ä–∏ –º–æ–¥–µ–ª—å ‚Üí –∑–∞–ø–æ–≤–Ω–∏ –±–∞–ª–∏ + –∫–æ–º–µ–Ω—Ç–∞—Ä—ñ ‚Üí —Å—Ñ–æ—Ä–º—É–π –≤–∏—Å–Ω–æ–≤–æ–∫ ‚Üí –ø–æ—Ä—ñ–≤–Ω—è–π ‚Üí –µ–∫—Å–ø–æ—Ä—Ç.</p>
    <div class="tabs">
      <button class="tab active" data-tab="t1">1) –ü–∞—Å–ø–æ—Ä—Ç</button>
      <button class="tab" data-tab="t2">2) –û—Ü—ñ–Ω–∫–∞</button>
      <button class="tab" data-tab="t3">3) –ß–µ–∫-–ª–∏—Å—Ç</button>
      <button class="tab" data-tab="t4">4) –ï–∫—Å–ø–æ—Ä—Ç</button>
      <button class="tab" data-tab="t5">5) –ü–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è</button>
    </div>
  </div>
</header>

<main class="wrap">

  <!-- TAB 1 –ü–∞—Å–ø–æ—Ä—Ç -->
  <section id="t1" class="grid cols2">
    <div class="card">
      <h2>–ê–≤—Ç–æ–∑–∞–ø–æ–≤–Ω–µ–Ω–Ω—è (–¥–æ–≤—ñ–¥–Ω–∏–∫)</h2>
      <label>–í–∏–±–µ—Ä–∏ –ë–µ–ù–ö –∑—ñ —Å–ø–∏—Å–∫—É</label>
      <div class="row">
        <select id="presetSelect">
          <option value="">‚Äî –æ–±—Ä–∞—Ç–∏ –º–æ–¥–µ–ª—å ‚Äî</option>
        </select>
        <button class="primary" type="button" id="applyPresetBtn">–ó–∞–ø–æ–≤–Ω–∏—Ç–∏</button>
      </div>

      <div class="divider"></div>

      <h2>–û—Å–Ω–æ–≤–Ω—ñ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏</h2>
      <label>ID (–Ω–æ–º–µ—Ä –∑–∞–ø–∏—Å—É)</label>
      <input id="id" type="number" min="1" placeholder="1,2,3..."/>

      <label>–í–∏—Ä–æ–±–Ω–∏–∫</label>
      <input id="maker"/>

      <label>–ù–∞–∑–≤–∞ –ë–µ–ù–ö</label>
      <input id="model"/>

      <label>–û—Ä—ñ—î–Ω—Ç–æ–≤–Ω–∞ —Ü—ñ–Ω–∞, –≥—Ä–Ω</label>
      <input id="price" type="number" min="0"/>

      <label>–°–∏–ª–æ–≤–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∞</label>
      <input id="power"/>

      <label>–ú–∞—Å–∞, –∫–≥</label>
      <input id="mass" type="number" min="0"/>

      <label>–†–æ–∑–º—ñ—Ä–∏, –º–º (–î—Ö–®—Ö–í)</label>
      <input id="dims" placeholder="2155x1509x904"/>

      <label>–ö–æ—Ä–∏—Å–Ω–µ –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è, –∫–≥</label>
      <input id="payloadNom" type="number" min="0"/>

      <label>–ú–∞–∫—Å —à–≤–∏–¥., –∫–º/–≥–æ–¥</label>
      <input id="maxSpeed" type="number" min="0"/>

      <label>–ó–∞–ø–∞—Å —Ö–æ–¥—É, –∫–º</label>
      <input id="rangeRoad" type="number" min="0"/>

      <div class="row">
        <div>
          <label>–ö–ª—ñ—Ä–µ–Ω—Å, –º–º</label>
          <input id="clearance" type="number" min="0"/>
        </div>
        <div>
          <label>–ö—É—Ç –ø—ñ–¥–π–æ–º—É, ¬∞</label>
          <input id="climb" type="number" min="0"/>
        </div>
      </div>

      <label>–ö—É—Ç –∫—Ä–µ–Ω—É, ¬∞</label>
      <input id="tilt" type="number" min="0"/>

      <div class="row">
        <div>
          <label>–û–ø—Ç–∏—á–Ω–∞</label>
          <select id="optical"><option value="-">-</option><option value="+">+</option></select>
        </div>
        <div>
          <label>–û–ø—Ç–∏—á–Ω–∞ –∑ –Ü–ß</label>
          <select id="opticalIR"><option value="-">-</option><option value="+">+</option></select>
        </div>
      </div>

      <label>–¢–µ–ø–ª–æ–≤—ñ–∑—ñ–π–Ω–∞</label>
      <select id="thermal"><option value="-">-</option><option value="+">+</option></select>

      <div class="row">
        <div>
          <label>–†–∞–¥—ñ–æ, –∫–º</label>
          <input id="radioKm" type="number" step="0.1" min="0"/>
        </div>
        <div>
          <label>Starlink</label>
          <select id="starlink"><option value="-">-</option><option value="+">+</option></select>
        </div>
      </div>

      <label>LTE</label>
      <select id="lte"><option value="-">-</option><option value="+">+</option></select>

      <label>–ü—Ä–∏–º—ñ—Ç–∫–∏</label>
      <textarea id="notes" placeholder="–¥–æ–¥–∞—Ç–∫–æ–≤—ñ –¥–µ—Ç–∞–ª—ñ/–∫–æ–º–ø–ª–µ–∫—Ç–∞—Ü—ñ—è..."></textarea>

      <div class="btnrow">
        <button class="primary" id="saveBtn">–ó–±–µ—Ä–µ–≥—Ç–∏</button>
        <button class="ghost" id="loadBtn">–ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏</button>
        <button class="danger" id="clearBtn">–û—á–∏—Å—Ç–∏—Ç–∏ —Ñ–æ—Ä–º—É</button>
      </div>
    </div>

    <div class="card">
      <h2>–®–≤–∏–¥–∫—ñ KPI</h2>
      <div class="kpi" id="kpi"></div>
      <p class="small">–¶–µ –Ω–µ ‚Äú–æ—Ü—ñ–Ω–∫–∞‚Äù, –∞ –ª–∏—à–µ —ñ–Ω–¥–∏–∫–∞—Ç–æ—Ä: –≥—Ä–Ω/–∫–≥ —Ç–∞ –≥—Ä–Ω/(–∫–≥¬∑–∫–º).</p>
    </div>
  </section>

  <!-- TAB 2 –û—Ü—ñ–Ω–∫–∞ + –∫–æ–º–µ–Ω—Ç–∞—Ä—ñ + –≤–∏—Å–Ω–æ–≤–æ–∫ -->
  <section id="t2" class="grid cols2 hide">
    <div class="card">
      <h2>–ö—Ä–∏—Ç–µ—Ä—ñ—ó 0‚Äì5 + –∫–æ–º–µ–Ω—Ç–∞—Ä—ñ</h2>
      <p class="small">–ü–æ—Å—Ç–∞–≤ –±–∞–ª–∏ —Ç–∞ –¥–æ–¥–∞–π —Ç–µ–∫—Å—Ç–æ–≤—ñ –∑–∞—É–≤–∞–∂–µ–Ω–Ω—è –ø–æ –∫–æ–∂–Ω–æ–º—É –ø—É–Ω–∫—Ç—É.</p>
      <div id="criteriaList"></div>
      <div class="btnrow">
        <button class="primary" id="calcBtn">–ü–æ—Ä–∞—Ö—É–≤–∞—Ç–∏</button>
        <button class="primary" id="generateConclusionBtn">–°—Ñ–æ—Ä–º—É–≤–∞—Ç–∏ –≤–∏—Å–Ω–æ–≤–æ–∫</button>
        <button class="ghost" id="saveScoreBtn">–ó–±–µ—Ä–µ–≥—Ç–∏ –æ—Ü—ñ–Ω–∫—É</button>
      </div>
      <div class="divider"></div>
      <div id="validationBox" class="small err"></div>
    </div>

    <div class="card">
      <h2>–†–µ–∑—É–ª—å—Ç–∞—Ç</h2>
      <div class="kpi">
        <span class="pill">–ë–∞–ª: <strong id="finalScore">‚Äî</strong></span>
        <span class="pill">–†—ñ—à–µ–Ω–Ω—è: <strong id="finalDecision">‚Äî</strong></span>
      </div>
      <div class="divider"></div>
      <div class="kpi">
        <span class="badge" id="riskBadge">–°–≤—ñ—Ç–ª–æ—Ñ–æ—Ä: <strong id="riskText">‚Äî</strong></span>
        <span class="pill">–ú—ñ–Ω. –∫–ª—é—á–æ–≤–∏–π: <strong id="minKey">‚Äî</strong></span>
      </div>
      <div class="divider"></div>
      <h2>–ó–∞–≥–∞–ª—å–Ω—ñ –∑–∞—É–≤–∞–∂–µ–Ω–Ω—è –∫–æ–º—ñ—Å—ñ—ó</h2>
      <textarea id="commissionNotes" placeholder="–ó–∞–≥–∞–ª—å–Ω—ñ –∫–æ–º–µ–Ω—Ç–∞—Ä—ñ –ø–æ –º–æ–¥–µ–ª—ñ..."></textarea>
    </div>
  </section>

  <!-- TAB 3 –ß–µ–∫-–ª–∏—Å—Ç -->
  <section id="t3" class="grid hide">
    <div class="card">
      <h2>–ß–µ–∫-–ª–∏—Å—Ç –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü—ñ—ó (‚úî/‚úñ)</h2>
      <div id="checklist"></div>
      <div class="btnrow">
        <button class="primary" id="saveChkBtn">–ó–±–µ—Ä–µ–≥—Ç–∏ —á–µ–∫-–ª–∏—Å—Ç</button>
        <button class="ghost" id="resetChkBtn">–°–∫–∏–Ω—É—Ç–∏ –ø–æ–∑–Ω–∞—á–∫–∏</button>
      </div>
    </div>
  </section>

  <!-- TAB 4 –ï–∫—Å–ø–æ—Ä—Ç -->
  <section id="t4" class="grid hide">
    <div class="card">
      <h2>–ï–∫—Å–ø–æ—Ä—Ç</h2>
      <p class="small">–ï–∫—Å–ø–æ—Ä—Ç —É—Å—ñ—Ö –∑–±–µ—Ä–µ–∂–µ–Ω–∏—Ö –æ—Ü—ñ–Ω–æ–∫ –≤ Excel (.xls).</p>
      <div class="btnrow">
        <button class="primary" id="exportExcelBtn">–ï–∫—Å–ø–æ—Ä—Ç –≤ Excel</button>
        <button class="danger" id="wipeAllBtn">–í–∏–¥–∞–ª–∏—Ç–∏ –≤—Å—ñ –¥–∞–Ω—ñ</button>
      </div>
    </div>
  </section>

  <!-- TAB 5 –ü–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è -->
  <section id="t5" class="grid hide">
    <div class="card">
      <h2>–ü–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è –º–æ–¥–µ–ª–µ–π</h2>
      <p class="small">–û–±–µ—Ä—ñ—Ç—å –º–æ–¥–µ–ª—ñ –∑ –¥–æ–≤—ñ–¥–Ω–∏–∫–∞ (–¥–æ 4, —É—Ç—Ä–∏–º—É—é—á–∏ Ctrl)</p>
      <select id="compareSelect" multiple size="10"></select>
      <div class="btnrow">
        <button class="primary" id="buildCompareBtn">–ü–æ—Ä—ñ–≤–Ω—è—Ç–∏</button>
        <button class="ghost" id="clearCompareBtn">–û—á–∏—Å—Ç–∏—Ç–∏</button>
      </div>
      <div id="compareTable" style="margin-top:20px; overflow-x:auto"></div>
    </div>
  </section>
</main>

<!-- –ú–æ–¥–∞–ª–∫–∞ –≤–∏—Å–Ω–æ–≤–∫—É -->
<div class="modalOverlay" id="conclusionModal">
  <div class="modal">
    <h3>–í–∏—Å–Ω–æ–≤–æ–∫ –∑–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ –æ—Ü—ñ–Ω–∫–∏</h3>
    <div class="meta" id="conclusionMeta"></div>
    <div class="box" id="conclusionText" style="white-space:pre-wrap; line-height:1.5"></div>
    <div class="modalCloseRow">
      <button class="primary" id="copyConclusion">–ö–æ–ø—ñ—é–≤–∞—Ç–∏ –≤ –±—É—Ñ–µ—Ä</button>
      <button class="ghost" id="closeConclusion">–ó–∞–∫—Ä–∏—Ç–∏</button>
    </div>
  </div>
</div>

<!-- –ú–æ–¥–∞–ª–∫–∞ –¥–æ–≤—ñ–¥–∫–∏ -->
<div class="modalOverlay" id="modalOverlay">
  <div class="modal">
    <h3 id="modalTitle">–î–æ–≤—ñ–¥–∫–∞</h3>
    <div class="meta" id="modalMeta"></div>
    <div class="box" id="modalScale"></div>
    <div class="box" id="modalHow"></div>
    <div class="box" id="modalQuestions"></div>
    <div class="modalCloseRow">
      <button class="ghost" id="modalCloseBtn">–ó–∞–∫—Ä–∏—Ç–∏</button>
    </div>
  </div>
</div>

<script>
const KEY = "nrk_app_v2026";

// –í–∞–≥–∏ –∫—Ä–∏—Ç–µ—Ä—ñ—ó–≤
const WEIGHTS = {
  payload: 0.12, mob: 0.10, end: 0.10, link: 0.16, reb: 0.14, sens: 0.08, deploy: 0.06, ops: 0.08, value: 0.16
};
const KEY_CRITERIA = ["link", "reb"];

// –î–æ–≤—ñ–¥–Ω–∏–∫ –º–æ–¥–µ–ª–µ–π
const PRESETS = [
  { group: "–í–∞–∂–∫—ñ –ª–æ–≥—ñ—Å—Ç–∏—á–Ω—ñ (–∫–æ–ª—ñ—Å–Ω—ñ)", maker: '–¢–û–í "–†–û–í–ï–†-–¢–ï–ö"', model: "–ó–ú–Ü–ô –õ–û–ì–Ü–°–¢–ò–ß–ù–ò–ô", price: 973409, power: "–µ–ª–µ–∫—Ç—Ä–∏—á–Ω–∏–π", mass: 850, dims: "2155x1509x904", payload: 500, maxSpeed: 8, rangeRoad: 20, clearance: 30, climb: 30, tilt: 30, optical: "-", opticalIR: "+", thermal: "-", radioKm: 1, starlink: "+", lte: "+" },
  { group: "–í–∞–∂–∫—ñ –ª–æ–≥—ñ—Å—Ç–∏—á–Ω—ñ (–∫–æ–ª—ñ—Å–Ω—ñ)", maker: '–¢–û–í "–î–û–î–ñ–ï–† –ù–†–ö"', model: "DODGER", price: 1190000, power: "–µ–ª–µ–∫—Ç—Ä–∏—á–Ω–∏–π", mass: 510, dims: "1590—Ö1170—Ö1300", payload: 250, maxSpeed: 10, rangeRoad: 20, clearance: 35, climb: 25, tilt: 25, optical: "-", opticalIR: "+", thermal: "-", radioKm: 2.5, starlink: "+", lte: "+" },
  { group: "–í–∞–∂–∫—ñ –ª–æ–≥—ñ—Å—Ç–∏—á–Ω—ñ (–∫–æ–ª—ñ—Å–Ω—ñ)", maker: '–¢–û–í "–ú–û–†–û–ó-–¢–ï–•"', model: "–ë–ù–ö MOROZ-02L", price: 1250000, power: "–µ–ª–µ–∫—Ç—Ä–∏—á–Ω–∏–π", mass: 720, dims: "2250—Ö1305—Ö1905", payload: 400, maxSpeed: 22, rangeRoad: 45, clearance: 23, climb: 23, tilt: 23, optical: "-", opticalIR: "-", thermal: "-", radioKm: 1, starlink: "+", lte: "+" },
  { group: "–í–∞–∂–∫—ñ –ª–æ–≥—ñ—Å—Ç–∏—á–Ω—ñ (–∫–æ–ª—ñ—Å–Ω—ñ)", maker: '–¢–û–í "–î–ñ–ï–ô–ö–ï–ô –õ–ï–ù–î –í–Ü–ö–õ–ó"', model: "RATEL –ú", price: 1300000, power: "–µ–ª–µ–∫—Ç—Ä–∏—á–Ω–∏–π", mass: 760, dims: "1800x1400x1820", payload: 300, maxSpeed: 8, rangeRoad: 32, clearance: 30, climb: 45, tilt: 45, optical: "-", opticalIR: "-", thermal: "-", radioKm: 1.1, starlink: "+", lte: "-" },
  { group: "–í–∞–∂–∫—ñ –ª–æ–≥—ñ—Å—Ç–∏—á–Ω—ñ (–∫–æ–ª—ñ—Å–Ω—ñ)", maker: '–¢–û–í "–ö–û–¢–ò–ì–û–†–û–®–ö–û"', model: "TOR 800", price: 1308500, power: "–µ–ª–µ–∫—Ç—Ä–∏—á–Ω–∏–π", mass: 700, dims: "2330x1680x1900", payload: 400, maxSpeed: 10, rangeRoad: 20, clearance: 30, climb: 30, tilt: 30, optical: "-", opticalIR: "+", thermal: "-", radioKm: 1, starlink: "+", lte: "-" },
  { group: "–í–∞–∂–∫—ñ –ª–æ–≥—ñ—Å—Ç–∏—á–Ω—ñ (–∫–æ–ª—ñ—Å–Ω—ñ)", maker: '–¢–û–í "–ö–û–¢–ò–ì–û–†–û–®–ö–û"', model: "TOR 1000", price: 1677500, power: "–µ–ª–µ–∫—Ç—Ä–∏—á–Ω–∏–π", mass: 1300, dims: "2544x1770x2215", payload: 700, maxSpeed: 10, rangeRoad: 30, clearance: 30, climb: 30, tilt: 30, optical: "-", opticalIR: "+", thermal: "-", radioKm: 1, starlink: "+", lte: "-" },
  { group: "–í–∞–∂–∫—ñ –ª–æ–≥—ñ—Å—Ç–∏—á–Ω—ñ (–∫–æ–ª—ñ—Å–Ω—ñ)", maker: '–¢–û–í "–î–ñ–ï–ô–ö–ï–ô –õ–ï–ù–î –í–Ü–ö–õ–ó"', model: "RATEL H", price: 2000000, power: "–µ–ª–µ–∫—Ç—Ä–∏—á–Ω–∏–π", mass: 900, dims: "2480x1300x740", payload: 400, maxSpeed: 8, rangeRoad: 10, clearance: 30, climb: 30, tilt: 30, optical: "+", opticalIR: "+", thermal: "-", radioKm: 1.1, starlink: "+", lte: "-" },
  { group: "–í–∞–∂–∫—ñ –ª–æ–≥—ñ—Å—Ç–∏—á–Ω—ñ (–∫–æ–ª—ñ—Å–Ω—ñ)", maker: '–¢–û–í "–†–Ü–í–ê-–°–¢–ê–õ–¨"', model: "D-21", price: 2155350, power: "–µ–ª–µ–∫—Ç—Ä–∏—á–Ω–∏–π", mass: 541, dims: "1390—Ö1245—Ö1363", payload: 200, maxSpeed: 10, rangeRoad: 14, clearance: 20, climb: 20, tilt: 20, optical: "-", opticalIR: "+", thermal: "-", radioKm: 1, starlink: "+", lte: "+" },
  { group: "–í–∞–∂–∫—ñ –ª–æ–≥—ñ—Å—Ç–∏—á–Ω—ñ (–∫–æ–ª—ñ—Å–Ω—ñ)", maker: '–¢–û–í "–£–ö–†–ê –á–ù–°–¨–ö–Ü –ë–ï–ó–ü–Ü–õ–û–¢–ù–Ü –¢–ï–•–ù–û–õ–û–ì–Ü –á"', model: "–£–ú–ü-–†–ê–í–õ–ò–ö-2", price: 2390000, power: "–µ–ª–µ–∫—Ç—Ä–∏—á–Ω–∏–π", mass: 620, dims: "2114x1322x1647", payload: 200, maxSpeed: 6, rangeRoad: 12, clearance: 30, climb: 20, tilt: 20, optical: "-", opticalIR: "+", thermal: "-", radioKm: 0.5, starlink: "+", lte: "-" },
  { group: "–í–∞–∂–∫—ñ –ª–æ–≥—ñ—Å—Ç–∏—á–Ω—ñ (–∫–æ–ª—ñ—Å–Ω—ñ)", maker: '–¢–û–í –ö–í–ü "–°–ò–ù–ï–†–ì–Ü–Ø"', model: "–ú–ò–†–û–¢–í–û–†–ï–¶–¨", price: 3205000, power: "–µ–ª–µ–∫—Ç—Ä–∏—á–Ω–∏–π", mass: 1050, dims: "3173x1602x1570", payload: 450, maxSpeed: 9, rangeRoad: 27, clearance: 30, climb: 20, tilt: 20, optical: "-", opticalIR: "+", thermal: "-", radioKm: 1, starlink: "-", lte: "-" },
  { group: "–í–∞–∂–∫—ñ –ª–æ–≥—ñ—Å—Ç–∏—á–Ω—ñ (–∫–æ–ª—ñ—Å–Ω—ñ)", maker: '–¢–û–í "–£–ö–†–ê –á–ù–°–¨–ö–ê –ë–†–û–ù–ï–¢–ï–•–ù–Ü–ö–ê"', model: "PROTECTOR", price: 3900000, power: "–î–í–ó", mass: 2230, dims: "5070x1900x1564", payload: 700, maxSpeed: 40, rangeRoad: 200, clearance: 30, climb: 25, tilt: 25, optical: "+", opticalIR: "+", thermal: "-", radioKm: 7, starlink: "+", lte: "+" },

  { group: "–í–∞–∂–∫—ñ –ª–æ–≥—ñ—Å—Ç–∏—á–Ω—ñ (–≥—É—Å–µ–Ω–∏—á–Ω—ñ)", maker: '–¢–û–í "–¢–ï–ù–ö–û–†"', model: "–¢–ï–†–ú–Ü–¢", price: 895000, power: "–µ–ª–µ–∫—Ç—Ä–∏—á–Ω–∏–π", mass: 569, dims: "1465—Ö1220—Ö1240", payload: 300, maxSpeed: 15, rangeRoad: 40, clearance: 30, climb: 25, tilt: 25, optical: "-", opticalIR: "+", thermal: "-", radioKm: 1.5, starlink: "+", lte: "-" },
  { group: "–í–∞–∂–∫—ñ –ª–æ–≥—ñ—Å—Ç–∏—á–Ω—ñ (–≥—É—Å–µ–Ω–∏—á–Ω—ñ)", maker: '–¢–û–í "–†–û–ë–û–¢–ò–ó–û–í–ê–ù–Ü –ö–û–ú–ü–õ–ï–ö–°–ò"', model: "–ú–£–†–ê–•–ê", price: 970200, power: "–µ–ª–µ–∫—Ç—Ä–∏—á–Ω–∏–π", mass: 630, dims: "1940—Ö1260—Ö1770", payload: 250, maxSpeed: 12, rangeRoad: 50, clearance: 35, climb: 20, tilt: 20, optical: "-", opticalIR: "+", thermal: "-", radioKm: 1, starlink: "+", lte: "-" },
  { group: "–í–∞–∂–∫—ñ –ª–æ–≥—ñ—Å—Ç–∏—á–Ω—ñ (–≥—É—Å–µ–Ω–∏—á–Ω—ñ)", maker: '–¢–û–í "–£–ö–†–ü–†–û–¢–û–¢–ò–ü"', model: "–ë–£–†–ï–í–Ü–ô", price: 1433000, power: "–µ–ª–µ–∫—Ç—Ä–∏—á–Ω–∏–π", mass: 1250, dims: "3000—Ö1700—Ö1240", payload: 600, maxSpeed: 12, rangeRoad: 40, clearance: 40, climb: 20, tilt: 20, optical: "+", opticalIR: "-", thermal: "+", radioKm: 2, starlink: "+", lte: "+" }
];

// –ö—Ä–∏—Ç–µ—Ä—ñ—ó –æ—Ü—ñ–Ω–∫–∏
const CRITERIA = [
  { id:"payload", name:"–ù–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è", short:"—Å–∫—ñ–ª—å–∫–∏ —Ä–µ–∞–ª—å–Ω–æ –≤–µ–∑–µ —ñ —è–∫ —Å—Ç–∞–±—ñ–ª—å–Ω–æ", weight:WEIGHTS.payload,
    scale:["0 ‚Äî <50% –≤—ñ–¥ –ø–æ—Ç—Ä–µ–± –∞–±–æ –Ω–µ—Å—Ç–∞–±—ñ–ª—å–Ω–æ –ø—ñ–¥ –≤–∞–Ω—Ç–∞–∂–µ–º","3 ‚Äî —Ç—è–≥–Ω–µ/–≤–µ–∑–µ —Ç–∏–ø–æ–≤—ñ –≤–∞–Ω—Ç–∞–∂—ñ —Å—Ç–∞–±—ñ–ª—å–Ω–æ","5 ‚Äî –º–∞—î –∑–∞–ø–∞—Å + —Å—Ç–∞–±—ñ–ª—å–Ω–∏–π —Ä—É—Ö/–ø–æ–≤–æ—Ä–æ—Ç –∑ –≤–∞–Ω—Ç–∞–∂–µ–º"],
    how:"–û—Ü—ñ–Ω—é–π –Ω–∞ –¥–µ–º–æ: —Ä—É—Ö 200‚Äì300 –º –∑ –≤–∞–Ω—Ç–∞–∂–µ–º, –ø–æ–≤–æ—Ä–æ—Ç, —Å—Ç–∞—Ä—Ç/—Å—Ç–æ–ø, —á–∏ –Ω–µ –ø—Ä–æ—Å—ñ–¥–∞—î —à–≤–∏–¥–∫—ñ—Å—Ç—å/–∫–µ—Ä–æ–≤–∞–Ω—ñ—Å—Ç—å.",
    questions:["–Ø–∫–∏–π –Ω–æ–º—ñ–Ω–∞–ª/–º–∞–∫—Å–∏–º—É–º (–ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–æ –¥–µ)?","–ü–æ–∫–∞–∂—ñ—Ç—å —Ä—É—Ö –∑ –Ω–æ–º—ñ–Ω–∞–ª—å–Ω–∏–º –≤–∞–Ω—Ç–∞–∂–µ–º 2 —Ä–∞–∑–∏ –ø—ñ–¥—Ä—è–¥.","–©–æ –ø—Ä–∏ –ø–µ—Ä–µ–≤–∏—â–µ–Ω–Ω—ñ: –∑–∞—Ö–∏—Å—Ç/–æ–±–º–µ–∂–µ–Ω–Ω—è?"] },
  { id:"mob", name:"–ü—Ä–æ—Ö—ñ–¥–Ω—ñ—Å—Ç—å", short:"—Ä–µ–∞–ª—å–Ω–∏–π “ë—Ä—É–Ω—Ç/—É—Ö–∏–ª–∏/–∫–æ–ª—ñ—è", weight:WEIGHTS.mob,
    scale:["0 ‚Äî –∑–∞—Å—Ç—Ä—è–≥–∞—î/–∑—Ä–∏–≤–∞—î –∫–µ—Ä—É–≤–∞–Ω–Ω—è","3 ‚Äî –¥–æ–ª–∞—î —Ç–∏–ø–æ–≤—ñ –ø–µ—Ä–µ—à–∫–æ–¥–∏","5 ‚Äî —Å—Ç–∞–±—ñ–ª—å–Ω–æ –Ω–∞ —É—Ö–∏–ª–∞—Ö/–±–∞–≥–Ω—é—Ü—ñ/–ø—ñ—Å–∫—É –∑ –≤–∞–Ω—Ç–∞–∂–µ–º"],
    how:"–ü—Ä–æ—Å–∏ –¥—ñ–ª—è–Ω–∫—É –∑ –∫–æ–ª—ñ—î—é/—É—Ö–∏–ª–æ–º. –í–∞–∂–ª–∏–≤–∞ –ø–æ–≤—Ç–æ—Ä—é–≤–∞–Ω—ñ—Å—Ç—å (2‚Äì3 –ø—Ä–æ—Ö–æ–¥–∏).",
    questions:["–Ø–∫–∏–π –∫—É—Ç –ø—ñ–¥–π–æ–º—É/–∫—Ä–µ–Ω—É –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–æ?","–ü–æ–∫–∞–∂—ñ—Ç—å –∫–æ–ª—ñ—é/–±–∞–≥–Ω—é–∫—É (2 –ø—Ä–æ—Ö–æ–¥–∏).","–Ñ –æ–±–º–µ–∂–µ–Ω–Ω—è –ø–æ —à–≤–∏–¥–∫–æ—Å—Ç—ñ –Ω–∞ –±–µ–∑–¥–æ—Ä—ñ–∂–∂—ñ?"] },
  { id:"end", name:"–ê–≤—Ç–æ–Ω–æ–º–Ω—ñ—Å—Ç—å", short:"—á–∞—Å/–¥–∏—Å—Ç–∞–Ω—Ü—ñ—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º—É —Ä–µ–∂–∏–º—ñ", weight:WEIGHTS.end,
    scale:["0 ‚Äî <1 –≥–æ–¥ –∞–±–æ <5 –∫–º (–∞–±–æ –Ω–µ–º–∞ –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è)","3 ‚Äî 2‚Äì3 –≥–æ–¥ –∞–±–æ 10‚Äì20 –∫–º (–ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–æ)","5 ‚Äî ‚â•4 –≥–æ–¥ –∞–±–æ ‚â•30 –∫–º (–ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–æ –∑ –≤–∞–Ω—Ç–∞–∂–µ–º)"],
    how:"–ù–µ –ø–ª—É—Ç–∞–π –ø–∞—Å–ø–æ—Ä—Ç —ñ –ø—Ä–∞–∫—Ç–∏–∫—É. –ü—Ä–æ—Å–∏ —Ä–µ–∂–∏–º: –≤–∞–Ω—Ç–∞–∂+—Å–µ—Ä–µ–¥–Ω—è —à–≤–∏–¥–∫—ñ—Å—Ç—å+—Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞.",
    questions:["–†–µ–∞–ª—å–Ω–∏–π —á–∞—Å –∑ –≤–∞–Ω—Ç–∞–∂–µ–º X –∫–≥ –ø—Ä–∏ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ñ Y?","–†–µ—Å—É—Ä—Å –ê–ö–ë/—Ü–∏–∫–ª–∏/—á–∞—Å –∑–∞—Ä—è–¥–∫–∏?","–ó–∞—Ö–∏—Å—Ç –ø—Ä–∏ —Ä–æ–∑—Ä—è–¥—ñ/–≤—ñ–¥—Å—ñ–∫–∞–Ω–Ω—è?"] },
  { id:"link", name:"–ó–≤‚Äô—è–∑–æ–∫/–∫–µ—Ä—É–≤–∞–Ω–Ω—è", short:"—Å—Ç–∞–±—ñ–ª—å–Ω—ñ—Å—Ç—å –∫–µ—Ä—É–≤–∞–Ω–Ω—è —ñ —Ä–µ–∑–µ—Ä–≤", weight:WEIGHTS.link,
    scale:["0 ‚Äî –æ–¥–∏–Ω –∫–∞–Ω–∞–ª, –Ω–µ—Å—Ç–∞–±—ñ–ª—å–Ω–∏–π","3 ‚Äî 1‚Äì2 –∫–∞–Ω–∞–ª–∏, –∞–ª–µ —Å–ª–∞–±–∫–∏–π —Ä–µ–∑–µ—Ä–≤/–ø–µ—Ä–µ–º–∏–∫–∞–Ω–Ω—è","5 ‚Äî ‚â•2 –∫–∞–Ω–∞–ª–∏ + —Ä–µ–∑–µ—Ä–≤ + –∑—Ä–æ–∑—É–º—ñ–ª–µ –ø–µ—Ä–µ–º–∏–∫–∞–Ω–Ω—è + –ø—Ä–∏–π–Ω—è—Ç–Ω–∞ –∑–∞—Ç—Ä–∏–º–∫–∞"],
    how:"–ö–ª—é—á–æ–≤–∏–π –∫—Ä–∏—Ç–µ—Ä—ñ–π: –¥–∞–ª—å–Ω—ñ—Å—Ç—å, latency, –ø–æ–≤–µ–¥—ñ–Ω–∫–∞ –ø—Ä–∏ –≤—Ç—Ä–∞—Ç—ñ —Å–∏–≥–Ω–∞–ª—É, –≤—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è –∫–µ—Ä—É–≤–∞–Ω–Ω—è.",
    questions:["–Ø–∫—ñ –∫–∞–Ω–∞–ª–∏ (–æ—Å–Ω–æ–≤–Ω–∏–π/—Ä–µ–∑–µ—Ä–≤–Ω–∏–π) —ñ —è–∫ –ø–µ—Ä–µ–º–∏–∫–∞—î—Ç—å—Å—è?","–ü–æ–∫–∞–∂—ñ—Ç—å –≤—Ç—Ä–∞—Ç—É –∫–∞–Ω–∞–ª—É —ñ –≤—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è 2 —Ä–∞–∑–∏.","–Ø–∫–∞ –∑–∞—Ç—Ä–∏–º–∫–∞ —ñ —è–∫ –º—ñ—Ä—è–ª–∏?"] },
  { id:"reb", name:"–†–ï–ë / Fail-safe", short:"–ø–æ–≤–µ–¥—ñ–Ω–∫–∞ –ø—Ä–∏ –∑–∞–≤–∞–¥–∞—Ö/–≤—Ç—Ä–∞—Ç—ñ", weight:WEIGHTS.reb,
    scale:["0 ‚Äî –Ω–µ–±–µ–∑–ø–µ—á–Ω–æ: –ø—Ä–æ–¥–æ–≤–∂—É—î —Ä—É—Ö/–Ω–µ —Ä–µ–∞–≥—É—î","3 ‚Äî –±–µ–∑–ø–µ—á–Ω–∞ –∑—É–ø–∏–Ω–∫–∞ –ø—Ä–∏ –≤—Ç—Ä–∞—Ç—ñ –∑–≤‚Äô—è–∑–∫—É","5 ‚Äî –∑—É–ø–∏–Ω–∫–∞ + –≤—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è/–ø–µ—Ä–µ—Ö—ñ–¥ –Ω–∞ —Ä–µ–∑–µ—Ä–≤ + –ø—Ä–æ–∑–æ—Ä–∞ –ª–æ–≥—ñ–∫–∞"],
    how:"–í–∏–º–∞–≥–∞–π –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü—ñ—é: —â–æ —á–µ—Ä–µ–∑ 1‚Äì3 —Å–µ–∫—É–Ω–¥–∏ –ø—ñ—Å–ª—è –≤—Ç—Ä–∞—Ç–∏ –∫–µ—Ä—É–≤–∞–Ω–Ω—è.",
    questions:["–õ–æ–≥—ñ–∫–∞ fail-safe: —Å—Ç–æ–ø/—Ä–µ–∂–∏–º –æ—á—ñ–∫—É–≤–∞–Ω–Ω—è/–ø–æ–≤–µ—Ä–Ω–µ–Ω–Ω—è?","–ß–∞—Å —Å–ø—Ä–∞—Ü—é–≤–∞–Ω–Ω—è?","–Ñ –ª–æ–≥ –ø–æ–¥—ñ–π?"] },
  { id:"sens", name:"–°–µ–Ω—Å–æ—Ä–∏", short:"–∫–∞–º–µ—Ä–∏/–Ω—ñ—á/—Ç–µ–ø–ª–æ + —Å—Ç–∞–±—ñ–ª—å–Ω—ñ—Å—Ç—å", weight:WEIGHTS.sens,
    scale:["0 ‚Äî –º—ñ–Ω—ñ–º–∞–ª—å–Ω–∞ –∫–∞–º–µ—Ä–∞/–ø–æ–≥–∞–Ω–∏–π –æ–≥–ª—è–¥","3 ‚Äî 2+ –∫–∞–º–µ—Ä–∏ –∞–±–æ –Ü–ß","5 ‚Äî –æ–≥–ª—è–¥ + —Ç–µ–ø–ª–æ–≤—ñ–∑ (–∑–∞ –ø–æ—Ç—Ä–µ–±–∏) + —Å—Ç–∞–±—ñ–ª—å–Ω–µ –≤—ñ–¥–µ–æ –≤ —Ä—É—Å—ñ"],
    how:"–û—Ü—ñ–Ω—é–π –∫–æ—Ä–∏—Å—Ç—å: –æ–≥–ª—è–¥ –ø—ñ–¥ –∫–æ–ª–µ—Å–∞, –ø–µ—Ä–µ–º–∏–∫–∞–Ω–Ω—è –∫–∞–º–µ—Ä, –ª–∞–≥–∏.",
    questions:["–î–µ –∫–∞–º–µ—Ä–∏? –Ñ –æ–≥–ª—è–¥ –ø—ñ–¥ –∫–æ–ª–µ—Å–∞?","–ü–µ—Ä–µ–º–∏–∫–∞–Ω–Ω—è –∫–∞–º–µ—Ä –ø—ñ–¥ —á–∞—Å —Ä—É—Ö—É?","–ù—ñ—á/–Ü–ß/—Ç–µ–ø–ª–æ (—è–∫ –∑–∞—è–≤–ª–µ–Ω–æ) –ø—ñ–¥—Ç–≤–µ—Ä–¥–∏—Ç–∏."] },
  { id:"deploy", name:"–†–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è", short:"—á–∞—Å —ñ –ø—Ä–æ—Å—Ç–æ—Ç–∞ –ø—ñ–¥–≥–æ—Ç–æ–≤–∫–∏", weight:WEIGHTS.deploy,
    scale:["0 ‚Äî >20 —Ö–≤","3 ‚Äî 5‚Äì10 —Ö–≤","5 ‚Äî ‚â§3 —Ö–≤ –ø—ñ—Å–ª—è —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç—É–≤–∞–Ω–Ω—è"],
    how:"–†–µ–∞–ª—å–Ω–æ: –≤–∏—Ç—è–≥–ª–∏ –∑ –∞–≤—Ç–æ ‚Üí –≤–≤—ñ–º–∫–Ω—É–ª–∏ ‚Üí –ø–æ—ó—Ö–∞–ª–∏. –¢–∞–π–º–µ—Ä.",
    questions:["–ü–æ–∫–∞–∂—ñ—Ç—å –∑–∞–ø—É—Å–∫ –∑ –Ω—É–ª—è –∑ —Ç–∞–π–º–µ—Ä–æ–º.","–°–∫—ñ–ª—å–∫–∏ –ª—é–¥–µ–π –ø–æ—Ç—Ä—ñ–±–Ω–æ?","–©–æ –≤ –∫–æ–º–ø–ª–µ–∫—Ç—ñ –¥–ª—è —à–≤–∏–¥–∫–æ–≥–æ —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è?"] },
  { id:"ops", name:"–ï–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—è/—Å–µ—Ä–≤—ñ—Å", short:"—Ä–µ–º–æ–Ω—Ç–æ–ø—Ä–∏–¥–∞—Ç–Ω—ñ—Å—Ç—å —ñ –ø—ñ–¥—Ç—Ä–∏–º–∫–∞", weight:WEIGHTS.ops,
    scale:["0 ‚Äî —Ä–µ–º–æ–Ω—Ç —Ç—ñ–ª—å–∫–∏ —É –≤–∏—Ä–æ–±–Ω–∏–∫–∞, –Ω–µ–º–∞ –ó–Ü–ü","3 ‚Äî –±–∞–∑–æ–≤–∏–π –ó–Ü–ü, —á–∞—Å—Ç–∫–æ–≤–∏–π —Ä–µ–º–æ–Ω—Ç","5 ‚Äî –ø–æ–ª—å–æ–≤–∏–π —Ä–µ–º–æ–Ω—Ç ‚â§30 —Ö–≤, –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è/–≥–∞—Ä–∞–Ω—Ç—ñ—è/–∑–∞–ø—á–∞—Å—Ç–∏–Ω–∏"],
    how:"–î–ª—è 1‚Äì2 –ª—ñ–Ω—ñ—ó –≤–∞–∂–ª–∏–≤–æ —à–≤–∏–¥–∫–æ –≤—ñ–¥–Ω–æ–≤–∏—Ç–∏ –ø—ñ—Å–ª—è –¥—Ä—ñ–±–Ω–∏—Ö –ø–æ—à–∫–æ–¥–∂–µ–Ω—å.",
    questions:["–Ø–∫–∏–π –ó–Ü–ü/–≤–∏—Ç—Ä–∞—Ç–Ω–∏–∫–∏ –≤ –∫–æ–º–ø–ª–µ–∫—Ç—ñ?","–ì–∞—Ä–∞–Ω—Ç—ñ—è, SLA, —Å–∫–ª–∞–¥ –∑–∞–ø—á–∞—Å—Ç–∏–Ω?","–ß–∞—Å –≤—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è —Ç–∏–ø–æ–≤–∏—Ö –ø–æ–ª–æ–º–æ–∫?"] },
  { id:"value", name:"–¶—ñ–Ω–∞/–µ—Ñ–µ–∫—Ç", short:"—á–∏ –Ω–µ –ø–µ—Ä–µ–ø–ª–∞—á—É—î–º–æ", weight:WEIGHTS.value,
    scale:["0 ‚Äî —Ü—ñ–Ω–∞ —è–≤–Ω–æ –∑–∞–≤–∏—â–µ–Ω–∞","3 ‚Äî —Ä–∏–Ω–∫–æ–≤–∞ –ø—Ä–∏ –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–∏—Ö –¢–¢–•","5 ‚Äî –Ω–∞–π–∫—Ä–∞—â–∞ —Ü—ñ–Ω–∞ –∑–∞ –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω—ñ –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ + –ø—Ä–æ–∑–æ—Ä–∞ –∫–æ–º–ø–ª–µ–∫—Ç–∞—Ü—ñ—è"],
    how:"–ü–æ—Ä—ñ–≤–Ω—é–π –Ω–µ –ø–∞—Å–ø–æ—Ä—Ç, –∞ –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–µ –Ω–∞ –¥–µ–º–æ (–∑–≤‚Äô—è–∑–æ–∫, fail-safe, –ø—Ä–æ—Ö—ñ–¥–Ω—ñ—Å—Ç—å, –≤–∞–Ω—Ç–∞–∂).",
    questions:["–©–æ –≤—Ö–æ–¥–∏—Ç—å —É –±–∞–∑–æ–≤—É —Ü—ñ–Ω—É?","–Ø–∫—ñ –æ–ø—Ü—ñ—ó –ø–ª–∞—Ç–Ω—ñ?","–í–∞—Ä—Ç—ñ—Å—Ç—å –µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—ó (–ê–ö–ë/—à–∏–Ω–∏/—Å–µ—Ä–≤—ñ—Å)?"] },
];

const checklistItems = [
  {k:"link_main", t:"–û—Å–Ω–æ–≤–Ω–∏–π –∫–∞–Ω–∞–ª –∫–µ—Ä—É–≤–∞–Ω–Ω—è —Å—Ç–∞–±—ñ–ª—å–Ω–∏–π (200‚Äì500 –º)"},
  {k:"link_res", t:"–†–µ–∑–µ—Ä–≤–Ω–∏–π –∫–∞–Ω–∞–ª –∫–µ—Ä—É–≤–∞–Ω–Ω—è –Ω–∞—è–≤–Ω–∏–π —ñ –ø–µ—Ä–µ–≤—ñ—Ä–µ–Ω–∏–π"},
  {k:"switching", t:"–ü–µ—Ä–µ–º–∏–∫–∞–Ω–Ω—è –∫–∞–Ω–∞–ª—ñ–≤ (–∞–≤—Ç–æ/—Ä—É—á–Ω–µ) –ø—Ä–∞—Ü—é—î"},
  {k:"failsafe", t:"Fail-safe –ø—Ä–∏ –≤—Ç—Ä–∞—Ç—ñ –∑–≤‚Äô—è–∑–∫—É –ø—Ä–∞—Ü—é—î"},
  {k:"failsafe_time", t:"–ß–∞—Å —Ä–µ–∞–∫—Ü—ñ—ó –Ω–∞ –≤—Ç—Ä–∞—Ç—É –∑–≤‚Äô—è–∑–∫—É ‚â§ 3 —Å"},
  {k:"payload_run", t:"–†—É—Ö –∑ –Ω–æ–º—ñ–Ω–∞–ª—å–Ω–∏–º –≤–∞–Ω—Ç–∞–∂–µ–º —Å—Ç–∞–±—ñ–ª—å–Ω–∏–π"},
  {k:"turn_loaded", t:"–ü–æ–≤–æ—Ä–æ—Ç –ø—ñ–¥ –≤–∞–Ω—Ç–∞–∂–µ–º –±–µ–∑ –∑—Ä–∏–≤—É/–∑–∞–∫–ª–∏–Ω—é–≤–∞–Ω–Ω—è"},
  {k:"slope", t:"–†—É—Ö –ø–æ —É—Ö–∏–ª—É (–∑–∞—è–≤–ª–µ–Ω–∏–π –∫—É—Ç) –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–æ"},
  {k:"cams", t:"–ö–∞–º–µ—Ä–∏ –ø—Ä–∞—Ü—é—é—Ç—å, –ø–µ—Ä–µ–º–∏–∫–∞–Ω–Ω—è –±–µ–∑ –∑–∞–≤–∏—Å–∞–Ω—å"},
  {k:"night", t:"–ù—ñ—á–Ω–∏–π —Ä–µ–∂–∏–º/–Ü–ß/—Ç–µ–ø–ª–æ–≤—ñ–∑ (—è–∫—â–æ –∑–∞—è–≤–ª–µ–Ω–æ) –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–æ"},
  {k:"overheat", t:"–ù–µ–º–∞—î –ø–µ—Ä–µ–≥—Ä—ñ–≤—É/–≤—ñ–¥–º–æ–≤ –ø—ñ–¥ –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è–º"},
  {k:"deploy_time", t:"–ß–∞—Å —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î –∑–∞—è–≤–ª–µ–Ω–æ–º—É"},
  {k:"zip", t:"–ó–Ü–ü/—ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç —É –∫–æ–º–ø–ª–µ–∫—Ç—ñ, –ø—Ä–æ–¥–µ–º–æ–Ω—Å—Ç—Ä–æ–≤–∞–Ω–æ"},
];

// ==================== –§–£–ù–ö–¶–Ü–á ====================

function loadState() { 
  try { return JSON.parse(localStorage.getItem(KEY)) || {records:[]}; } 
  catch(e) { return {records:[]}; } 
}
function saveState(state) { localStorage.setItem(KEY, JSON.stringify(state)); }
function getRecordById(id) { return loadState().records.find(r => String(r.id) === String(id)); }
function upsertRecord(rec) {
  const st = loadState();
  const idx = st.records.findIndex(r => String(r.id) === String(rec.id));
  if (idx >= 0) st.records[idx] = rec; else st.records.push(rec);
  saveState(st);
}

function valNum(id) { const v = document.getElementById(id)?.value; return v === "" ? null : Number(v); }
function valStr(id) { return document.getElementById(id)?.value || ""; }
function setVal(id, v) { const el = document.getElementById(id); if (el) el.value = (v == null || v === undefined) ? "" : v; }

function switchTab(id) {
  document.querySelectorAll(".tab").forEach(b => b.classList.toggle("active", b.dataset.tab === id));
  document.querySelectorAll("main section").forEach(s => s.classList.toggle("hide", s.id !== id));
}
document.querySelectorAll(".tab").forEach(b => b.addEventListener("click", () => switchTab(b.dataset.tab)));

// KPI
function renderKPI() {
  const price = valNum("price");
  const payload = valNum("payloadNom");
  const range = valNum("rangeRoad");
  const box = document.getElementById("kpi");
  box.innerHTML = "";

  if (price && payload) {
    box.insertAdjacentHTML("beforeend", `<span class="pill">–≥—Ä–Ω/–∫–≥: <strong>${(price/payload).toFixed(0)}</strong></span>`);
  }
  if (price && payload && range) {
    box.insertAdjacentHTML("beforeend", `<span class="pill">–≥—Ä–Ω/(–∫–≥¬∑–∫–º): <strong>${(price/(payload*range)).toFixed(2)}</strong></span>`);
  }
  if (!box.innerHTML) {
    box.innerHTML = `<span class="pill">–ó–∞–ø–æ–≤–Ω–∏ ‚Äú–¶—ñ–Ω–∞‚Äù, ‚Äú–ù–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è‚Äù —ñ ‚Äú–ó–∞–ø–∞—Å —Ö–æ–¥—É‚Äù</span>`;
  }
}

// –ü—Ä–µ—Å–µ—Ç–∏
function presetKey(p) { return `${p.group} ‚Äî ${p.model} (${p.maker})`; }

function fillPresetSelect() {
  const sel = document.getElementById("presetSelect");
  if (!sel) return;
  sel.innerHTML = `<option value="">‚Äî –æ–±—Ä–∞—Ç–∏ –º–æ–¥–µ–ª—å ‚Äî</option>`;
  const groups = {};
  PRESETS.forEach(p => (groups[p.group] ||= []).push(p));
  Object.keys(groups).forEach(g => {
    const og = document.createElement("optgroup");
    og.label = g;
    groups[g].forEach(p => {
      const opt = document.createElement("option");
      opt.value = presetKey(p);
      opt.textContent = `${p.model} ‚Äî ${p.price.toLocaleString("uk-UA")} –≥—Ä–Ω`;
      og.appendChild(opt);
    });
    sel.appendChild(og);
  });
}

function applyPresetByKey(key) {
  const p = PRESETS.find(x => presetKey(x) === key);
  if (!p) return;

  setVal("maker", p.maker);
  setVal("model", p.model);
  setVal("price", p.price);
  setVal("power", p.power);
  setVal("mass", p.mass);
  setVal("dims", p.dims);
  setVal("payloadNom", p.payload);
  setVal("maxSpeed", p.maxSpeed);
  setVal("rangeRoad", p.rangeRoad);
  setVal("clearance", p.clearance);
  setVal("climb", p.climb);
  setVal("tilt", p.tilt);

  document.getElementById("optical").value = p.optical || "-";
  document.getElementById("opticalIR").value = p.opticalIR || "-";
  document.getElementById("thermal").value = p.thermal || "-";
  setVal("radioKm", p.radioKm);
  document.getElementById("starlink").value = p.starlink || "-";
  document.getElementById("lte").value = p.lte || "-";

  renderKPI();
}

function wirePresetUI() {
  const btn = document.getElementById("applyPresetBtn");
  const sel = document.getElementById("presetSelect");
  btn.addEventListener("click", () => {
    if (!sel.value) return alert("–û–±–µ—Ä–∏ –º–æ–¥–µ–ª—å.");
    applyPresetByKey(sel.value);
    alert("–ó–∞–ø–æ–≤–Ω–µ–Ω–æ!");
  });
}

// –ö—Ä–∏—Ç–µ—Ä—ñ—ó –∑ –∫–æ–º–µ–Ω—Ç–∞—Ä—è–º–∏
function renderCriteria() {
  const box = document.getElementById("criteriaList");
  box.innerHTML = "";
  CRITERIA.forEach(c => {
    box.insertAdjacentHTML("beforeend", `
      <div class="crit">
        <div class="critTop">
          <div class="critName">
            <b>${c.name}</b>
            <span>${c.short}</span>
          </div>
          <div class="critActions">
            <span class="weightTag">–≤–∞–≥–∞ ${(c.weight*100).toFixed(0)}%</span>
            <button class="helpBtn" data-help="${c.id}">–î–æ–≤—ñ–¥–∫–∞</button>
          </div>
        </div>
        <label>–û—Ü—ñ–Ω–∫–∞ 0‚Äì5</label>
        <input id="s_${c.id}" type="number" min="0" max="5" placeholder="0..5"/>
        <label>–ö–æ–º–µ–Ω—Ç–∞—Ä / –∑–∞—É–≤–∞–∂–µ–Ω–Ω—è</label>
        <textarea id="c_${c.id}" placeholder="–©–æ –Ω–µ –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–æ, —â–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ –¥–æ–æ–ø—Ä–∞—Ü—é–≤–∞—Ç–∏..."></textarea>
      </div>
    `);
  });

  document.querySelectorAll("[data-help]").forEach(btn => btn.addEventListener("click", e => openHelp(e.target.dataset.help)));

  CRITERIA.forEach(c => document.getElementById("s_"+c.id).addEventListener("input", () => calcFinal(false)));
}

const modalOverlay = document.getElementById("modalOverlay");
const modalTitle = document.getElementById("modalTitle");
const modalMeta = document.getElementById("modalMeta");
const modalScale = document.getElementById("modalScale");
const modalHow = document.getElementById("modalHow");
const modalQuestions = document.getElementById("modalQuestions");

function openHelp(id) {
  const c = CRITERIA.find(x => x.id === id);
  if (!c) return;
  modalTitle.textContent = c.name + " ‚Äî —è–∫ –æ—Ü—ñ–Ω—é–≤–∞—Ç–∏";
  modalMeta.textContent = `–í–∞–≥–∞ ${(c.weight*100).toFixed(0)}%. ${c.short}`;
  modalScale.innerHTML = `<b>–®–∫–∞–ª–∞</b><br><br><div class="small">${c.scale.map(s => `‚Ä¢ ${s}`).join("<br>")}</div>`;
  modalHow.innerHTML = `<b>–Ø–∫ –æ—Ü—ñ–Ω—é–≤–∞—Ç–∏</b><br><br><div class="small">${c.how}</div>`;
  modalQuestions.innerHTML = `<b>–©–æ –ø—Ä–æ—Å–∏—Ç–∏ –Ω–∞ –¥–µ–º–æ</b><br><br><div class="small">${c.questions.map(q => `‚Ä¢ ${q}`).join("<br>")}</div>`;
  modalOverlay.style.display = "flex";
}
document.getElementById("modalCloseBtn").addEventListener("click", () => modalOverlay.style.display = "none");
modalOverlay.addEventListener("click", e => { if (e.target === modalOverlay) modalOverlay.style.display = "none"; });

// –ß–µ–∫-–ª–∏—Å—Ç
function renderChecklist() {
  const box = document.getElementById("checklist");
  box.innerHTML = "";
  checklistItems.forEach(it => {
    box.insertAdjacentHTML("beforeend", `
      <div class="row" style="align-items:center;gap:10px;padding:10px;border:1px solid var(--line);border-radius:12px;margin:8px 0;background:rgba(0,0,0,.10)">
        <input type="checkbox" id="chk_${it.k}" style="width:18px;height:18px;"/>
        <div style="font-size:13px">${it.t}</div>
      </div>
    `);
  });
}
function collectChecklist() {
  const out = {};
  checklistItems.forEach(it => {
    const el = document.getElementById("chk_"+it.k);
    out[it.k] = el ? el.checked : false;
  });
  return out;
}

// Scoring
function collectScoring() {
  const s = {};
  CRITERIA.forEach(c => {
    const v = document.getElementById("s_"+c.id)?.value;
    s[c.id] = v === "" ? null : Number(v);
  });
  return s;
}
function validateScoring(sc) {
  const errors = [];
  CRITERIA.forEach(c => {
    const v = sc[c.id];
    if (v === null || isNaN(v)) errors.push(`‚Ä¢ ${c.name} ‚Äî –Ω–µ –∑–∞–ø–æ–≤–Ω–µ–Ω–æ`);
    else if (v < 0 || v > 5) errors.push(`‚Ä¢ ${c.name} ‚Äî –∑–Ω–∞—á–µ–Ω–Ω—è –ø–æ–∑–∞ –¥—ñ–∞–ø–∞–∑–æ–Ω–æ–º 0‚Äì5`);
  });
  return errors;
}
function calcFinal(showAlert = true) {
  const sc = collectScoring();
  const errors = validateScoring(sc);
  const vbox = document.getElementById("validationBox");
  if (errors.length) {
    vbox.innerHTML = "<b>–ü–æ–º–∏–ª–∫–∏:</b><br>" + errors.join("<br>");
    setSummary(null, null, null);
    if (showAlert) alert("–ó–∞–ø–æ–≤–Ω—ñ—Ç—å —É—Å—ñ –±–∞–ª–∏ –∫–æ—Ä–µ–∫—Ç–Ω–æ.");
    return null;
  }
  vbox.textContent = "";

  let total = 0;
  CRITERIA.forEach(c => total += c.weight * (sc[c.id] || 0));
  total = Math.round(total * 100) / 100;

  let decision = "–£–º–æ–≤–Ω–æ —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–æ";
  if (total >= 4.0) decision = "–†–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–æ";
  else if (total < 3.2) decision = "–ù–µ —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–æ";

  const keyMin = Math.min(...KEY_CRITERIA.map(k => sc[k] || 0));
  const allMin = Math.min(...CRITERIA.map(c => sc[c.id] || 0));

  let risk = { color: "green", text: "üü¢ –ü—Ä–∏–π–Ω—è—Ç–Ω–æ" };
  if (keyMin < 3) risk = { color: "red", text: "üî¥ –í–∏—Å–æ–∫–∏–π —Ä–∏–∑–∏–∫ (–∑–≤‚Äô—è–∑–æ–∫/Fail-safe)" };
  else if (allMin < 3) risk = { color: "yellow", text: "üü° –û–±–º–µ–∂–µ–Ω–Ω—è (—î —Å–ª–∞–±–∫—ñ –º—ñ—Å—Ü—è)" };

  setSummary(total, decision, { risk, keyMin });
  return { total, decision, risk };
}

function setSummary(score, decision, riskObj) {
  document.getElementById("finalScore").textContent = score === null ? "‚Äî" : score.toFixed(2);
  document.getElementById("finalDecision").textContent = decision || "‚Äî";

  const badge = document.getElementById("riskBadge");
  const rText = document.getElementById("riskText");
  const minKey = document.getElementById("minKey");
  badge.className = "badge";
  if (riskObj) {
    rText.textContent = riskObj.risk.text;
    minKey.textContent = riskObj.keyMin;
    badge.classList.add(riskObj.risk.color);
  } else {
    rText.textContent = "‚Äî";
    minKey.textContent = "‚Äî";
  }
}

// –í–∏—Å–Ω–æ–≤–æ–∫
document.getElementById("generateConclusionBtn")?.addEventListener("click", () => {
  const res = calcFinal(false);
  if (!res) return;

  const model = valStr("model") || "[–º–æ–¥–µ–ª—å]";
  const score = res.total.toFixed(2);
  const decision = res.decision;
  const risk = res.risk.text;

  let text = `–í–∏—Å–Ω–æ–≤–æ–∫ –ø–æ –º–æ–¥–µ–ª—ñ ${model}\n\n`;
  text += `–ü—ñ–¥—Å—É–º–∫–æ–≤–∏–π –±–∞–ª: ${score}\n`;
  text += `–†—ñ—à–µ–Ω–Ω—è: ${decision}\n`;
  text += `–°–≤—ñ—Ç–ª–æ—Ñ–æ—Ä: ${risk}\n\n`;

  text += "–°–∏–ª—å–Ω—ñ —Å—Ç–æ—Ä–æ–Ω–∏:\n";
  CRITERIA.forEach(c => {
    const v = valNum("s_"+c.id);
    if (v >= 4) text += `‚Ä¢ ${c.name} ‚Äî ${v} –±–∞–ª—ñ–≤\n`;
  });

  text += "\n–°–ª–∞–±–∫—ñ –º—ñ—Å—Ü—è —Ç–∞ –∑–∞—É–≤–∞–∂–µ–Ω–Ω—è:\n";
  CRITERIA.forEach(c => {
    const v = valNum("s_"+c.id);
    const comm = valStr("c_"+c.id).trim();
    if (v <= 3 && v !== null) {
      text += `‚Ä¢ ${c.name} ‚Äî ${v} –±–∞–ª—ñ–≤`;
      if (comm) text += ` (${comm})`;
      text += "\n";
    }
  });

  text += "\n–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è:\n";
  if (res.total >= 4.0) text += "–†–µ–∫–æ–º–µ–Ω–¥—É—î–º–æ –ø—Ä–∏–π–Ω—è—Ç–∏ / –∑–∞–∫—É–ø–∏—Ç–∏.";
  else if (res.total >= 3.2) text += "–£–º–æ–≤–Ω–æ —Ä–µ–∫–æ–º–µ–Ω–¥—É—î–º–æ –ø—ñ—Å–ª—è —É—Å—É–Ω–µ–Ω–Ω—è –∑–∞—É–≤–∞–∂–µ–Ω—å.";
  else text += "–ù–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É—î–º–æ.";

  document.getElementById("conclusionMeta").textContent = `–û—Ü—ñ–Ω–∫–∞ –≤—ñ–¥ ${valStr("evaluator") || "–Ω–µ–≤—ñ–¥–æ–º–æ"} | ${new Date().toLocaleString("uk-UA")}`;
  document.getElementById("conclusionText").textContent = text;
  document.getElementById("conclusionModal").style.display = "flex";
});

document.getElementById("closeConclusion")?.addEventListener("click", () => document.getElementById("conclusionModal").style.display = "none");

document.getElementById("copyConclusion")?.addEventListener("click", () => {
  const text = document.getElementById("conclusionText").textContent;
  navigator.clipboard.writeText(text).then(() => alert("–í–∏—Å–Ω–æ–≤–æ–∫ —Å–∫–æ–ø—ñ–π–æ–≤–∞–Ω–æ –≤ –±—É—Ñ–µ—Ä!"));
});

// –ü–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è (–≤–∏–ø—Ä–∞–≤–ª–µ–Ω–æ)
function updateCompareSelect() {
  const sel = document.getElementById("compareSelect");
  if (!sel) return;
  sel.innerHTML = "";

  const groups = {};
  PRESETS.forEach(p => (groups[p.group] ||= []).push(p));
  Object.keys(groups).forEach(g => {
    const og = document.createElement("optgroup");
    og.label = g;
    groups[g].forEach(p => {
      const opt = document.createElement("option");
      opt.value = presetKey(p);
      opt.textContent = `${p.model} ‚Äî ${p.price.toLocaleString("uk-UA")} –≥—Ä–Ω (${p.maker})`;
      og.appendChild(opt);
    });
    sel.appendChild(og);
  });

  if (sel.options.length === 0) {
    sel.innerHTML = '<option disabled>–ú–æ–¥–µ–ª—ñ –≤—ñ–¥—Å—É—Ç–Ω—ñ –≤ –¥–æ–≤—ñ–¥–Ω–∏–∫—É</option>';
  }
}

function buildCompareTable() {
  const sel = document.getElementById("compareSelect");
  if (!sel) {
    console.error("–ù–µ –∑–Ω–∞–π–¥–µ–Ω–æ –µ–ª–µ–º–µ–Ω—Ç #compareSelect");
    return;
  }

  const keys = Array.from(sel.selectedOptions).map(o => o.value);
  if (keys.length < 2) {
    alert("–û–±–µ—Ä—ñ—Ç—å –ø—Ä–∏–Ω–∞–π–º–Ω—ñ 2 –º–æ–¥–µ–ª—ñ (—É—Ç—Ä–∏–º—É–π—Ç–µ Ctrl –¥–ª—è –º–Ω–æ–∂–∏–Ω–Ω–æ–≥–æ –≤–∏–±–æ—Ä—É)");
    return;
  }

  let html = `<table><tr><th>–ü–∞—Ä–∞–º–µ—Ç—Ä</th>`;
  keys.forEach(key => {
    const p = PRESETS.find(x => presetKey(x) === key);
    html += `<th>${p ? p.model : key}</th>`;
  });
  html += `</tr>`;

  const params = [
    ["–¶—ñ–Ω–∞, –≥—Ä–Ω", "price"],
    ["–ù–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è, –∫–≥", "payload"],
    ["–ú–∞–∫—Å —à–≤–∏–¥–∫—ñ—Å—Ç—å, –∫–º/–≥–æ–¥", "maxSpeed"],
    ["–ó–∞–ø–∞—Å —Ö–æ–¥—É, –∫–º", "rangeRoad"],
    ["–ö–ª—ñ—Ä–µ–Ω—Å, –º–º", "clearance"],
    ["–ö—É—Ç –ø—ñ–¥–π–æ–º—É, ¬∞", "climb"],
    ["–ö—É—Ç –∫—Ä–µ–Ω—É, ¬∞", "tilt"],
    ["–ú–∞—Å–∞, –∫–≥", "mass"],
    ["–†–æ–∑–º—ñ—Ä–∏", "dims"],
    ["–°–∏–ª–æ–≤–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∞", "power"],
    ["–†–∞–¥—ñ–æ, –∫–º", "radioKm"],
    ["–û–ø—Ç–∏—á–Ω–∞", "optical"],
    ["–û–ø—Ç–∏—á–Ω–∞ –∑ –Ü–ß", "opticalIR"],
    ["–¢–µ–ø–ª–æ–≤—ñ–∑—ñ–π–Ω–∞", "thermal"],
    ["Starlink", "starlink"],
    ["LTE", "lte"]
  ];

  params.forEach(([label, key]) => {
    html += `<tr><td>${label}</td>`;
    keys.forEach(k => {
      const p = PRESETS.find(x => presetKey(x) === k);
      html += `<td>${p?.[key] ?? "‚Äî"}</td>`;
    });
    html += "</tr>";
  });

  html += "</table>";
  const tableDiv = document.getElementById("compareTable");
  if (tableDiv) {
    tableDiv.innerHTML = html;
  } else {
    console.error("–ù–µ –∑–Ω–∞–π–¥–µ–Ω–æ –µ–ª–µ–º–µ–Ω—Ç #compareTable");
  }
}

// –ï–∫—Å–ø–æ—Ä—Ç (–±–µ–∑ –∑–º—ñ–Ω)
function exportExcelXls() {
  const st = loadState();
  const rows = [];

  rows.push([
    "ID","–í–∏—Ä–æ–±–Ω–∏–∫","–ù–∞–∑–≤–∞","–¶—ñ–Ω–∞","–°–∏–ª–æ–≤–∞","–ú–∞—Å–∞","–†–æ–∑–º—ñ—Ä–∏",
    "–ù–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è","–ú–∞–∫—Å —à–≤–∏–¥–∫—ñ—Å—Ç—å","–ó–∞–ø–∞—Å —Ö–æ–¥—É","–ö–ª—ñ—Ä–µ–Ω—Å","–ü—ñ–¥–π–æ–º","–ö—Ä–µ–Ω",
    "–û–ø—Ç–∏—á–Ω–∞","–û–ø—Ç–∏—á–Ω–∞ –Ü–ß","–¢–µ–ø–ª–æ–≤—ñ–∑–æ—Ä","–†–∞–¥—ñ–æ","Starlink","LTE",
    "–ü—ñ–¥—Å—É–º–∫–æ–≤–∏–π –±–∞–ª","–†—ñ—à–µ–Ω–Ω—è","–°–≤—ñ—Ç–ª–æ—Ñ–æ—Ä","–ú—ñ–Ω –∫–ª—é—á–æ–≤–∏–π","–ó–∞–≥–∞–ª—å–Ω—ñ –∑–∞—É–≤–∞–∂–µ–Ω–Ω—è",
    ...CRITERIA.map(c => `–ë–∞–ª: ${c.name}`),
    ...CRITERIA.map(c => `–ö–æ–º–µ–Ω—Ç–∞—Ä: ${c.name}`)
  ]);

  st.records.forEach(r => {
    const ex = computeScoreForExport(r.scoring || {});
    const row = [
      r.id ?? "", r.maker ?? "", r.model ?? "", r.price ?? "", r.power ?? "", r.mass ?? "", r.dims ?? "",
      r.payloadNom ?? "", r.maxSpeed ?? "", r.rangeRoad ?? "", r.clearance ?? "", r.climb ?? "", r.tilt ?? "",
      r.optical ?? "-", r.opticalIR ?? "-", r.thermal ?? "-", r.radioKm ?? "", r.starlink ?? "-", r.lte ?? "-",
      ex.score, ex.decision, ex.risk, ex.keyMin, r.commissionNotes ?? "",
      ...CRITERIA.map(c => r.scoring?.[c.id] ?? ""),
      ...CRITERIA.map(c => r.comments?.[c.id] ?? "")
    ];
    rows.push(row);
  });

  const xls = buildExcelXml("–û—Ü—ñ–Ω—é–≤–∞–Ω–Ω—è –ù–†–ö", rows);
  downloadFile(`NRK_–æ—Ü—ñ–Ω—é–≤–∞–Ω–Ω—è_${new Date().toISOString().slice(0,10)}.xls`, xls, "application/vnd.ms-excel");
}

function computeScoreForExport(sc) {
  if (!sc) return {score:"", decision:"", risk:"", keyMin:""};
  let total = 0;
  CRITERIA.forEach(c => total += c.weight * (sc[c.id] || 0));
  total = Math.round(total * 100) / 100;
  let decision = "–£–º–æ–≤–Ω–æ —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–æ";
  if (total >= 4.0) decision = "–†–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–æ";
  else if (total < 3.2) decision = "–ù–µ —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–æ";

  const keyMin = Math.min(...KEY_CRITERIA.map(k => sc[k] || 0));
  const allMin = Math.min(...CRITERIA.map(c => sc[c.id] || 0));
  let risk = "GREEN";
  if (keyMin < 3) risk = "RED";
  else if (allMin < 3) risk = "YELLOW";

  return {score: total.toFixed(2), decision, risk, keyMin: String(keyMin)};
}

function buildExcelXml(sheetName, rows) {
  const esc = s => String(s ?? "").replaceAll("&", "&amp;").replaceAll("<", "&lt;").replaceAll(">", "&gt;");
  const rowXml = rows.map(r => {
    const cells = r.map(v => {
      const isNum = typeof v === "number" || (String(v).trim() && !isNaN(Number(v)));
      return `<Cell><Data ss:Type="${isNum ? 'Number' : 'String'}">${esc(v)}</Data></Cell>`;
    }).join("");
    return `<Row>${cells}</Row>`;
  }).join("");

  return `<?xml version="1.0"?>
<Workbook xmlns="urn:schemas-microsoft-com:office:spreadsheet"
 xmlns:o="urn:schemas-microsoft-com:office:office"
 xmlns:x="urn:schemas-microsoft-com:office:excel"
 xmlns:ss="urn:schemas-microsoft-com:office:spreadsheet">
  <Worksheet ss:Name="${esc(sheetName)}">
    <Table>
      ${rowXml}
    </Table>
  </Worksheet>
</Workbook>`;
}

function downloadFile(name, content, mime) {
  const blob = new Blob([content], {type: mime});
  const a = document.createElement("a");
  a.href = URL.createObjectURL(blob);
  a.download = name;
  a.click();
  setTimeout(() => URL.revokeObjectURL(a.href), 5000);
}

// –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è —Ñ–æ—Ä–º–∏
function collectForm() {
  const data = {
    id: valNum("id"),
    maker: valStr("maker"),
    model: valStr("model"),
    price: valNum("price"),
    power: valStr("power"),
    mass: valNum("mass"),
    dims: valStr("dims"),
    payloadNom: valNum("payloadNom"),
    maxSpeed: valNum("maxSpeed"),
    rangeRoad: valNum("rangeRoad"),
    clearance: valNum("clearance"),
    climb: valNum("climb"),
    tilt: valNum("tilt"),
    optical: valStr("optical"),
    opticalIR: valStr("opticalIR"),
    thermal: valStr("thermal"),
    radioKm: valNum("radioKm"),
    starlink: valStr("starlink"),
    lte: valStr("lte"),
    notes: valStr("notes"),
    scoring: collectScoring(),
    comments: {},
    commissionNotes: valStr("commissionNotes"),
    checklist: collectChecklist()
  };
  CRITERIA.forEach(c => {
    data.comments[c.id] = valStr("c_" + c.id);
  });
  return data;
}

function fillForm(r) {
  if (!r) return;
  setVal("id", r.id);
  setVal("maker", r.maker);
  setVal("model", r.model);
  setVal("price", r.price);
  setVal("power", r.power);
  setVal("mass", r.mass);
  setVal("dims", r.dims);
  setVal("payloadNom", r.payloadNom);
  setVal("maxSpeed", r.maxSpeed);
  setVal("rangeRoad", r.rangeRoad);
  setVal("clearance", r.clearance);
  setVal("climb", r.climb);
  setVal("tilt", r.tilt);

  document.getElementById("optical").value = r.optical || "-";
  document.getElementById("opticalIR").value = r.opticalIR || "-";
  document.getElementById("thermal").value = r.thermal || "-";
  setVal("radioKm", r.radioKm);
  document.getElementById("starlink").value = r.starlink || "-";
  document.getElementById("lte").value = r.lte || "-";

  document.getElementById("notes").value = r.notes || "";
  document.getElementById("commissionNotes").value = r.commissionNotes || "";

  const sc = r.scoring || {};
  CRITERIA.forEach(c => setVal("s_" + c.id, sc[c.id]));

  const cm = r.comments || {};
  CRITERIA.forEach(c => setVal("c_" + c.id, cm[c.id] || ""));

  const chk = r.checklist || {};
  checklistItems.forEach(it => {
    const el = document.getElementById("chk_" + it.k);
    if (el) el.checked = !!chk[it.k];
  });

  renderKPI();
  calcFinal(false);
}

/** ---------- –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è ---------- **/
renderCriteria();
renderChecklist();
renderKPI();
fillPresetSelect();
wirePresetUI();
updateCompareSelect(); // –∑–∞–ø–æ–≤–Ω—é—î–º–æ —Å–ø–∏—Å–æ–∫ –ø–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è –≤—ñ–¥—Ä–∞–∑—É

// –ü—Ä–∏–∫—Ä—ñ–ø–ª—é—î–º–æ –æ–±—Ä–æ–±–Ω–∏–∫–∏ –¥–ª—è –∫–Ω–æ–ø–æ–∫ –ø–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è
const compareBtn = document.getElementById("buildCompareBtn");
if (compareBtn) {
  compareBtn.addEventListener("click", buildCompareTable);
} else {
  console.error("–ö–Ω–æ–ø–∫–∞ #buildCompareBtn –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–∞");
}

const clearBtn = document.getElementById("clearCompareBtn");
if (clearBtn) {
  clearBtn.addEventListener("click", () => {
    document.getElementById("compareTable").innerHTML = "";
  });
}

document.getElementById("weightsHint").textContent =
  "–í–∞–≥–∏: –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è 12%, –ø—Ä–æ—Ö—ñ–¥–Ω—ñ—Å—Ç—å 10%, –∞–≤—Ç–æ–Ω–æ–º–Ω—ñ—Å—Ç—å 10%, –∑–≤'—è–∑–æ–∫ 16%, –†–ï–ë/Fail-safe 14%, —Å–µ–Ω—Å–æ—Ä–∏ 8%, —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è 6%, –µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—è 8%, —Ü—ñ–Ω–∞/–µ—Ñ–µ–∫—Ç 16%.";
</script>
</body>
</html>